function [traj, time] = GetTrajs(data,d,maxTimestamp,samplingStep)%% This function returns the flow and time arrays of the date (d) in data%% (matrix that contains multiple days of flow of one cell)    traj = [];    time = [];    % Add a date column    data = [data zeros(rows(data),1)];    data(:,11) = datenum(strcat('2015-07-',d));        j = 1;    for t = 1:maxTimestamp        if j > rows(data(:,2))            traj = [traj;0];            time = [time;t+maxTimestamp*(str2num(d)-1)];            continue;        end        if data(j,2) > t            traj = [traj;0];            time = [time;t+maxTimestamp*(str2num(d)-1)];        else            traj = [traj;data(j,5)];            time = [time;t+maxTimestamp*(str2num(d)-1)];            j = j + 1;        end        end    if not (samplingStep == 1)        traj = mean(reshape(traj,samplingStep,[]))';        time = min(reshape(time,samplingStep,[]))'/samplingStep+1;    end end